---
layout: post
title: JPA2 - the potential to revolutionize Java development?
date: '2009-05-13T23:01:00.001+02:00'
author: Jonas Bandi
tags:
- programming
- javablog
- java
modified_time: '2009-05-17T17:06:17.789+02:00'
thumbnail: http://lh4.ggpht.com/_X3kaawac_g4/SgszqfAjBTI/AAAAAAAAAdY/djRoZj6GMAE/s72-c/innovation.jpg?imgmax=800
blogger_id: tag:blogger.com,1999:blog-5763764290649132593.post-3541076811439681408
blogger_orig_url: http://blog.jonasbandi.net/2009/05/jpa2-potential-to-revolutionize-java.html
---

<img style="margin: 0px 0px 10px 10px" src="http://lh4.ggpht.com/_X3kaawac_g4/SgszqfAjBTI/AAAAAAAAAdY/djRoZj6GMAE/innovation.jpg?imgmax=800" alt="innovation.jpg" border="0" width="190" align="right" />

The proposed final draft of JPA2 (<a href="http://jcp.org/en/jsr/detail?id=317">JSR 317</a>) is out for more than a month now.
<br/>
<br/>
Between the public review version and the proposed final draft, a significant detail was added. This detail might well be overlooked, but in my opinion it has the potential to revolutionize Java development.
<br/>
<br/>
I am talking about the <strong>JPA Metamodel API</strong>.
<br/>
<br/>
With the new Metamodel API, queries can become almost completely typesafe. This is achieved by exposing a typesafe metamodel of the entity model. 
<br/>
<br/>
This metamodel is actually nothing fancy, it is represented as simple annotated Java classes <span style="font-size:9px">(ups... I might just have lost all the heavyweight MDSD guys ;-))</span>
<br/>
<br/>
Now, the usage of Java classes with public static fields to get typesafety is hardly something new. I have been on several project that successfully leverage this.
<br/>
<br/>
Of course it makes sense to generate those classes. Therefore most of the projects using this concept have developed some homegrown generator infrastructure. This is usually where the problems start... this infrastructure is mostly proprietary, can be clumsy or outdated, needs special instructions and intricate knowhow. It can and therefore will fail, it interrupts the build process and prevents a seamless development experience <span style="font-size:9px">(Of course thats just my point of view :-))</span>
<br/>
<br/>
That's exactly where the revolutionary potential of the proposed implementation of the new JPA Metamodel API kicks in.
<br/>
<br/>
According to spec lead Linda Michiel's <a href="http://blogs.sun.com/ldemichiel/entry/java_persistence_2_0_proposed">Blog</a>:
<blockquote>We plan to release an annotation processor to be run in conjunction with javac to generate these classes.</blockquote>
<br/>
Gavin King (founder of <a href="http://hibernate.org/">Hibernate</a> and <a href="http://seamframework.org/">Seam</a>, spec lead of <a href="http://jcp.org/en/jsr/detail?id=299">JSR 299</a>) was the originator of the idea for this typesafe Metamodel API. <a href="http://in.relation.to/Bloggers/ATypesafeCriteriaQueryAPIForJPA">On his blog</a> he presents the idea to realize the code generation process as an APT plugin for javac:
<blockquote>So I've just spent several days researching the capabilities of javac Processors, and it's very clear that you can generate the necessary types as part of the compilation process. So no tool will be required. (This is a very exciting new language feature of Java 6, by the way).</blockquote>
<br/>
Emmanuel Bernard (founder of <a href="https://www.hibernate.org/410.html">Hibernate Search</a>, spec lead of <a href="http://jcp.org/en/jsr/detail?id=303">JSR 303</a>) comments on <a href="http://blogs.sun.com/ldemichiel/entry/java_persistence_2_0_proposed">Linda Michiel's Blog</a>:

<blockquote>Note that while the IDE can explicitly generate the metamodel on the fly, it can also delegate to the annotation processor that is triggered by the Java compiler. Even if the IDE has no specific JPA plugin, the metamodel is still generated on the fly. Same for plain old command line compilation.</blockquote>
<br/>

As readers of my blog might have noticed, I am <a href="http://blog.jonasbandi.net/2008/11/musing-about-code-generation-mdsd-and.html">not the biggest fan of code generation</a>.
But the above quotes sparked my interest, especially since they come from two bright minds that seem to have a <a href="http://twitter.com/emmanuelbernard/statuses/1240748322">sane opinion</a> in the religulous debate of code generation.
<br/>
<br/>
So I guess it would be an appropriate moment to look into the <a href="http://java.sun.com/javase/6/docs/api/javax/annotation/processing/package-summary.html">javax.annotation.processing package</a> of JDK 6.
<br/>
<br/>
As <a href="http://simonmartinelli.blogspot.com/2009/04/jpa-20-proposed-final-draft.html">others</a> have noted, the typesafe Metamodel API helps Java to catch up to <a href="http://de.wikipedia.org/wiki/LINQ">LINQ</a> in .NET.
<br/>
<br/>
<img style="margin: 10px 10px 0px 0px" src="http://lh6.ggpht.com/_X3kaawac_g4/Sgs1qxOjn5I/AAAAAAAAAdc/66kRqwma3wg/revolution.jpg?imgmax=800" alt="revolution.jpg" border="0" width="180" align="left" />
<em>But I think it has more potential!</em> <br/>
If the generation process is really seamlessly integrated into the compilation process, then this could offer the means to overcome a lot of the deficiencies of the Java language. 
<br/>
Specifically areas where the lack of method and field literals prevents elegant solutions can now be tackled.
<br/>
By extending the compilation process, its may even be possible to venture into areas where traditionally dynamically typed languages are especially strong ...
<br/>
<br/>
<strong>Update:</strong>
There is even more Information on Gavins Blog: <a href="http://in.relation.to/Bloggers/Java6CompilerPluginsAndTypesafeCriteriaQueries">Java 6 compiler plugins and typesafe criteria queries</a> and <a href="http://in.relation.to/Bloggers/LindaBlogsTheTypesafeQueryAPIForJPA20">Linda blogs the typesafe query API for JPA 2.0</a>
<br/>
<br/>
<div style="align:right; font-size: 10px; clear:right; ">
<br/>
<p><a  href="http://twitter.com/jbandi"><img style="margin: 0px 0px 0px 0px" src="http://www.google.com/s2/favicons?domain=twitter.com" alt="http://www.google.com/s2/favicons?domain=twitter.com" border="0" align="left" height="13px"/> follow me on twitter, I need some friends :-)</a></p></div>