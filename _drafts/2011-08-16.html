---
layout: post
title: 
date: '2011-08-16T12:18:00.001+02:00'
author: Jonas Bandi
tags: 
modified_time: '2011-08-16T12:38:01.365+02:00'
blogger_id: tag:blogger.com,1999:blog-5763764290649132593.post-6270352602112591567
---

Project is sealed class with no public constructor.<br />
http://msdn.microsoft.com/en-us/library/microsoft.teamfoundation.workitemtracking.client.project.aspx<br />
<br />
I am using Moles to isolate my classes from the TFS-API (Microsoft.TeamFoundation.WorkItemTracking.Client)<br />
<br />
Then I want to create a Mock of an class that takes a Project as constructor argument.<br />
<br />
FakeItEasy did not work for me:<br />
<br />
var filter = A.Fake<pageviewerfilter>(prototype =&gt; new PageViewerFilter(project, "", "", true));<br /><br />

</pageviewerfilter><br />
<pre><code>
FakeItEasy.Core.FakeCreationException: 
  Failed to create fake of type "my.namespace.PageUpdaterWebpart.PageViewerFilter".

  Below is a list of reasons for failure per attempted constructor:
    No constructor arguments failed:
      No default constructor was found on the type my.namespace.PageUpdaterWebpart.PageViewerFilter.
    The following constructors were not tried:
      (*Microsoft.TeamFoundation.WorkItemTracking.Client.Project, System.String, System.String, System.Boolean)

      Types marked with * could not be resolved, register them in the current
      IFakeObjectContainer to enable these constructors.
</code></pre>
<br />
NSubstitute<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; //var filter = new PageViewerFilter(project, "", "", true) {TextField = "RWSParam"};<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; var filter = Substitute.For<pageviewerfilter>(project, "", "", true);</pageviewerfilter><br />
<br />
<br />
<pre><code>
System.ArgumentException: Can not instantiate proxy of class: BIT.EIS.SharePoint.PageUpdaterWebpart.PageViewerFilter.
Could not find a constructor that would match given arguments:
Microsoft.TeamFoundation.WorkItemTracking.Client.Moles.MProject
System.String
System.String
System.Boolean


</code></pre>
